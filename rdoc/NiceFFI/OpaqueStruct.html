<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
	<meta content="text/html; charset=utf-8" http-equiv="Content-Type" />

	<title>Class: NiceFFI::OpaqueStruct</title>

	<link rel="stylesheet" href="../rdoc.css" type="text/css" media="screen" />

	<script src="../js/jquery.js" type="text/javascript"
		charset="utf-8"></script>
	<script src="../js/thickbox-compressed.js" type="text/javascript"
		charset="utf-8"></script>
	<script src="../js/quicksearch.js" type="text/javascript"
		charset="utf-8"></script>
	<script src="../js/darkfish.js" type="text/javascript"
		charset="utf-8"></script>

</head>
<body class="class">

	<div id="metadata">
		<div id="file-metadata">
			<div id="file-list-section" class="section">
				<h3 class="section-header">In Files</h3>
				<div class="section-body">
					<ul>
					
						<li><a href="../lib/nice-ffi/opaquestruct_rb.html?TB_iframe=true&amp;height=550&amp;width=785"
							class="thickbox" title="lib/nice-ffi/opaquestruct.rb">lib/nice-ffi/opaquestruct.rb</a></li>
					
					</ul>
				</div>
			</div>

			
		</div>

		<div id="class-metadata">

			<!-- Parent Class -->
			
			<div id="parent-class-section" class="section">
				<h3 class="section-header">Parent</h3>
				
				<p class="link">Object</p>
				
			</div>
			

			<!-- Namespace Contents -->
			

			<!-- Method Quickref -->
			
			<div id="method-list-section" class="section">
				<h3 class="section-header">Methods</h3>
				<ul class="link-list">
					
					<li><a href="#M000042">::new</a></li>
					
					<li><a href="#M000041">::typed_pointer</a></li>
					
					<li><a href="#M000045">#inspect</a></li>
					
					<li><a href="#M000043">#to_ptr</a></li>
					
					<li><a href="#M000044">#to_s</a></li>
					
				</ul>
			</div>
			

			<!-- Included Modules -->
			
			<div id="includes-section" class="section">
				<h3 class="section-header">Included Modules</h3>
				<ul class="link-list">
				
				
					<li><a class="include" href="../NiceFFI.html">NiceFFI</a></li>
				
				
				</ul>
			</div>
			
		</div>

		<div id="project-metadata">
			
			
			<div id="fileindex-section" class="section project-section">
				<h3 class="section-header">Files</h3>
				<ul>
				
					<li class="file"><a href="../README_rdoc.html">README.rdoc</a></li>
				
					<li class="file"><a href="../TODO_rdoc.html">TODO.rdoc</a></li>
				
					<li class="file"><a href="../docs/usage_rdoc.html">usage.rdoc</a></li>
				
				</ul>
			</div>
			

			<div id="classindex-section" class="section project-section">
				<h3 class="section-header">Class Index
					<span class="search-toggle"><img src="../images/find.png"
						height="16" width="16" alt="[+]"
						title="show/hide quicksearch" /></span></h3>
				<form action="#" method="get" accept-charset="utf-8" class="initially-hidden">
				<fieldset>
					<legend>Quicksearch</legend>
					<input type="text" name="quicksearch" value=""
						class="quicksearch-field" />
				</fieldset>
				</form>

				<ul class="link-list">
				
					<li><a href="../NiceFFI.html">NiceFFI</a></li>
				
					<li><a href="../NiceFFI/AutoRelease.html">NiceFFI::AutoRelease</a></li>
				
					<li><a href="../NiceFFI/Library.html">NiceFFI::Library</a></li>
				
					<li><a href="../NiceFFI/OpaqueStruct.html">NiceFFI::OpaqueStruct</a></li>
				
					<li><a href="../NiceFFI/PathSet.html">NiceFFI::PathSet</a></li>
				
					<li><a href="../NiceFFI/Struct.html">NiceFFI::Struct</a></li>
				
					<li><a href="../NiceFFI/TypedPointer.html">NiceFFI::TypedPointer</a></li>
				
				</ul>
				<div id="no-class-search-results" style="display: none;">No matching classes.</div>
			</div>

			
		</div>
	</div>

	<div id="documentation">
		<h1 class="class">NiceFFI::OpaqueStruct</h1>

		<div id="description">
			<p>
<a href="OpaqueStruct.html">OpaqueStruct</a> represents a <a
href="Struct.html">Struct</a> with an unknown layout. This is meant to be
used when the C library designer has intentionally hidden the layout (e.g.
to prevent user access).
</p>
<p>
Because the size of an <a href="OpaqueStruct.html">OpaqueStruct</a> is
unknown, you should only use methods provided by the C library to allocate,
modify, or free the struct&#8217;s memory.
</p>
<p>
<a href="OpaqueStruct.html">OpaqueStruct</a> supports the same memory
autorelease system as NiceStruct. Define MyClass.release( pointer ) to call
the library function to free the struct, and pass an FFI::Pointer to <a
href="OpaqueStruct.html#M000042">new</a>. You can disable autorelease for
an individual instance by providing {:autorelease => false} as an option to
<a href="OpaqueStruct.html#M000042">new</a>
</p>

		</div>

		<!-- Constants -->
		

		<!-- Attributes -->
		
		<div id="attribute-method-details" class="method-section section">
			<h3 class="section-header">Attributes</h3>

			
			<div id="pointer-attribute-method" class="method-detail">
				<a name="pointer"></a>
				
				<div class="method-heading attribute-method-heading">
					<span class="method-name">pointer</span><span
						class="attribute-access-type">[R]</span>
				</div>

				<div class="method-description">
				
				<p class="missing-docs">(Not documented)</p>
				
				</div>
			</div>
			
		</div>
		

		<!-- Methods -->
		
		<div id="public-class-method-details" class="method-section section">
			<h3 class="section-header">Public Class Methods</h3>

		
			<div id="new-method" class="method-detail ">
				<a name="M000042"></a>

				<div class="method-heading">
				
					<span class="method-name">new</span><span
						class="method-args">( val, options={} )</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Create a new instance of the class, wrapping (not copying!) a FFI::Pointer.
You can pass another instance of this class to create a new instance
wrapping the same pointer.
</p>
<p>
If val is an instance of FFI::Pointer and you have defined MyClass.release,
the pointer will be passed to MyClass.release when the memory is no longer
being used. Use MyClass.release to free the memory for the struct, as
appropriate for your class. To disable autorelease for this instance, set
{:autorelease => false} in <tt>options</tt>.
</p>
<p>
(Note: FFI::MemoryPointer and FFI::Buffer have built-in memory management,
so MyClass.release is never called for them.)
</p>
					

					
					<div class="method-source-code"
						id="new-source">
<pre>
<span class="ruby-comment cmt"># File lib/nice-ffi/opaquestruct.rb, line 69</span>
  <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">initialize</span>( <span class="ruby-identifier">val</span>, <span class="ruby-identifier">options</span>={} )
    <span class="ruby-identifier">options</span> = {<span class="ruby-identifier">:autorelease</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">true</span>}.<span class="ruby-identifier">merge!</span>( <span class="ruby-identifier">options</span> )

    <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">val</span>

    <span class="ruby-keyword kw">when</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">class</span>
      <span class="ruby-identifier">initialize</span>( <span class="ruby-identifier">val</span>.<span class="ruby-identifier">pointer</span>, <span class="ruby-identifier">options</span> )

    <span class="ruby-keyword kw">when</span> <span class="ruby-constant">FFI</span><span class="ruby-operator">::</span><span class="ruby-constant">AutoPointer</span>
      <span class="ruby-ivar">@pointer</span> = <span class="ruby-identifier">val</span>

    <span class="ruby-keyword kw">when</span> <span class="ruby-constant">FFI</span><span class="ruby-operator">::</span><span class="ruby-constant">Pointer</span>
      <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">val</span>.<span class="ruby-identifier">is_a?</span> <span class="ruby-constant">FFI</span><span class="ruby-operator">::</span><span class="ruby-constant">MemoryPointer</span> <span class="ruby-keyword kw">or</span> <span class="ruby-identifier">val</span>.<span class="ruby-identifier">is_a?</span> <span class="ruby-constant">FFI</span><span class="ruby-operator">::</span><span class="ruby-constant">Buffer</span>
        <span class="ruby-identifier">raise</span> <span class="ruby-constant">TypeError</span>, <span class="ruby-node">&quot;unsupported pointer type #{val.class.name}&quot;</span>
      <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">val</span>.<span class="ruby-identifier">null?</span>
        <span class="ruby-ivar">@pointer</span> = <span class="ruby-identifier">val</span>
      <span class="ruby-keyword kw">else</span>
        <span class="ruby-ivar">@pointer</span> = <span class="ruby-identifier">_make_autopointer</span>( <span class="ruby-identifier">val</span>, <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:autorelease</span>] )
      <span class="ruby-keyword kw">end</span>

    <span class="ruby-keyword kw">else</span>
      <span class="ruby-identifier">raise</span> <span class="ruby-constant">TypeError</span>, <span class="ruby-node">&quot;cannot create new #{self.class} from #{val.inspect}&quot;</span>

    <span class="ruby-keyword kw">end</span>
  <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				
			</div>

		
			<div id="typed-pointer-method" class="method-detail ">
				<a name="M000041"></a>

				<div class="method-heading">
				
					<span class="method-name">typed_pointer</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Returns a <a href="TypedPointer.html">NiceFFI::TypedPointer</a> instance
for this class.
</p>
					

					
					<div class="method-source-code"
						id="typed-pointer-source">
<pre>
<span class="ruby-comment cmt"># File lib/nice-ffi/opaquestruct.rb, line 50</span>
  <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">typed_pointer</span>
    <span class="ruby-ivar">@typed_pointer</span> <span class="ruby-keyword kw">or</span> (<span class="ruby-ivar">@typed_pointer</span> = <span class="ruby-constant">NiceFFI</span><span class="ruby-operator">::</span><span class="ruby-constant">TypedPointer</span>.<span class="ruby-identifier">new</span>(<span class="ruby-keyword kw">self</span>))
  <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				
			</div>

		
		</div>
	
		<div id="public-instance-method-details" class="method-section section">
			<h3 class="section-header">Public Instance Methods</h3>

		
			<div id="inspect-method" class="method-detail method-alias">
				<a name="M000045"></a>

				<div class="method-heading">
				
					<span class="method-name">inspect</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Alias for <a href="OpaqueStruct.html#M000044">to_s</a>
</p>
					

					
				</div>

				
			</div>

		
			<div id="to-ptr-method" class="method-detail ">
				<a name="M000043"></a>

				<div class="method-heading">
				
					<span class="method-name">to_ptr</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p class="missing-docs">(Not documented)</p>
					

					
					<div class="method-source-code"
						id="to-ptr-source">
<pre>
<span class="ruby-comment cmt"># File lib/nice-ffi/opaquestruct.rb, line 98</span>
  <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">to_ptr</span>
    <span class="ruby-ivar">@pointer</span>
  <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				
			</div>

		
			<div id="to-s-method" class="method-detail ">
				<a name="M000044"></a>

				<div class="method-heading">
				
					<span class="method-name">to_s</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p class="missing-docs">(Not documented)</p>
					

					
					<div class="method-source-code"
						id="to-s-source">
<pre>
<span class="ruby-comment cmt"># File lib/nice-ffi/opaquestruct.rb, line 103</span>
  <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">to_s</span>
    <span class="ruby-value str">&quot;#&lt;%s:%#.x&gt;&quot;</span><span class="ruby-operator">%</span>[<span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">class</span>.<span class="ruby-identifier">name</span>, <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">object_id</span>]
  <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				
				<div class="aliases">
					Also aliased as: <a href="OpaqueStruct.html#M000045">inspect</a>
				</div>
				
			</div>

		
		</div>
	

	</div>


	<div id="rdoc-debugging-section-dump" class="debugging-section">
	
		<p>Disabled; run with --debug to generate this.</p>
	
	</div>

	<div id="validator-badges">
		<p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
		<p><small>Generated with the <a href="http://deveiate.org/projects/Darkfish-Rdoc/">Darkfish
			Rdoc Generator</a> 1.1.6</small>.</p>
	</div>

</body>
</html>

